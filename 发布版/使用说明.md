# 自主超链接 (AutoHyperlink) 操作手册

## 1. 软件简介
本工具旨在自动监控指定文件夹中的文件变化，并将新增文件的信息（文件名、日期、链接）自动写入到指定的 Excel 收文目录中。无需人工手动复制粘贴链接，极大提高资料归档效率。

**新特性**：支持“无感运行”模式——打开文件夹自动开始监控，关闭文件夹自动停止监控。

## 2. 环境要求
- **操作系统**：Windows 10 / 11
- **软件依赖**：无（本工具已打包为独立 EXE 程序，无需安装 Python 环境）

## 3. 部署说明
### 3.1 获取程序
- 找到 `发布版` 文件夹下的两个文件：
  1. `AutoHyperlink.exe` (蓝色显示器图标 - 核心工作程序)
  2. `FolderMonitor.exe` (蓝色显示器图标 - 智能监控启动器)

### 3.2 放置位置
1. 将这两个文件**同时**复制到您需要监控的**根目录**下（例如：`E:\项目资料`）。
2. **注意**：两个文件必须在同一目录下。

### 3.3 准备 Excel 目录文件
- 在程序同级目录下，必须存在一个 Excel 收文目录文件。
- **命名规范**：文件名必须符合 `20xx工区收文目录.xls` 格式（例如 `2025工区收文目录.xls`）。
- **格式要求**：该 Excel 文件应为标准的 `.xls` 格式（非 `.xlsx`）。

## 4. 使用方法（无感模式）
### 4.1 启动智能监控
- 双击运行 `FolderMonitor.exe` **一次**。
- 该程序启动后没有任何界面（静默运行），它会驻留在后台。
- **建议**：如果您希望每次开机都自动生效，可以将 `FolderMonitor.exe` 的快捷方式放入 Windows 的“启动”文件夹中。

### 4.2 自动运行机制
- **打开文件夹即运行**：当您打开该文件夹（或其子文件夹）的资源管理器窗口时，监控服务 (`AutoHyperlink.exe`) 会自动在后台启动。
- **关闭文件夹即停止**：当您关闭所有该文件夹的窗口后，监控服务会自动关闭。
- **全程静默**：整个过程没有任何弹窗或黑框，完全不打扰您的工作。

### 4.3 验证是否工作
- 尝试往文件夹里放入一个新文件。
- 打开 `收文目录.xls`，查看最后一行是否新增了记录。

### 4.4 如何彻底停止
- 由于程序是静默运行的，如果您需要彻底停止监控，请打开**任务管理器**。
- 找到 `FolderMonitor.exe` 和 `AutoHyperlink.exe` 进程，右键选择“结束任务”。

## 5. 常见问题与注意事项

### 5.1 常见问题
| 现象 | 可能原因 | 解决方法 |
| :--- | :--- | :--- |
| **文件添加后 Excel 未更新** | Excel 被占用或文件名不匹配 | 关闭 Excel 文件；检查目录文件名是否正确。 |
| **不知道程序是否在运行** | 静默模式特性 | 打开任务管理器查看是否有 `AutoHyperlink.exe` 进程。 |
| **图标看起来没有变化** | Windows 图标缓存未刷新 | 重启“Windows 资源管理器”，或按 5.3 清理图标缓存。 |

### 5.2 注意事项
1. **不要手动运行 AutoHyperlink.exe**：在无感模式下，由 `FolderMonitor` 自动管理它。如果您手动双击运行 `AutoHyperlink.exe`，它也会静默运行，但不会自动关闭。
2. **多文件夹部署**：如果您有多个不同的项目文件夹需要监控，请将两个 EXE 复制到每个文件夹中，并分别运行各自的 `FolderMonitor.exe`。

### 5.3 图标缓存刷新
- **推荐方法**：直接双击运行文件夹中的 `刷新图标缓存.bat` 脚本。
- **手动方法**：
  1. 打开任务管理器，找到“Windows 资源管理器”，右键“重新启动”。
  2. 或者在 PowerShell 中执行以下命令：
     ```powershell
     Stop-Process -ProcessName explorer -Force; Remove-Item -Path "$env:localappdata\Microsoft\Windows\Explorer\iconcache*" -Force -ErrorAction SilentlyContinue; Start-Process explorer
     ```

## 6. 开发者维护
- **源码位置**：
  - `测试文件/auto_hyperlink.py` (核心逻辑)
  - `测试文件/folder_monitor.py` (监控逻辑)
- **构建脚本**：`测试文件/build_exe.bat`
- **重新打包**：
  运行 `build_exe.bat` 即可同时生成两个 EXE 文件。
